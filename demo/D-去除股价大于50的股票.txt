import pandas as pd
import numpy as np

def initialize(context):
    g.stocks = []
    
def before_trading_start(context, data):
    g.stocks = get_Ashares()
    price_choice()
    print(len(g.stocks),g.stocks)
    
def price_choice():
    price_dict=get_history(1, '1d', 'close',g.stocks, fq='pre',include=True,fill='pre')
    #对数据进行处理，最终去除股价大于50的股票
    for i in g.stocks.copy():
        close_dict = price_dict[price_dict["code"].isin([i])]
        price_close = close_dict["close"]
        if price_close.item() > 50 :
            g.stocks.remove(i)

def handle_data(context, data):
    pass